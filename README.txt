Учения

Условие:
Как известно, страна Башляндия находится на n островах, некоторые из
которых соединены мостами.

Из-за участившихся нападений пиратов министр обороны Башляндии решил
провести внеочередные учения морской пехоты. Для начала он собрал k морских
пехотинцев на острове 1 и приказал им как можно быстрее добраться по мостам
до острова n – так, чтобы среднее время пехотинца в пути было минимально возможным.
При этом, чтобы не нервировать мирных жителей, никакие два пехотинца не должны бежать
по одному и тому же мосту (даже в разное время).

К сожалению, морские пехотинцы плохо разбираются в теории графов, поэтому
они попросили вас помочь им выбрать оптимальные маршруты.

Формат ввода:
В первой строке входного файла находятся числа n, m и k – количество островов
и мостов в Башляндии и морских пехотинцев соответственно (2 ≤ n ≤ 200, 1 ≤ m ≤ 2000, 1 ≤ k ≤ 100).
Следующие m строк содержат по три целых положительных числа каждая – острова,
которые соединяет соответствующий мост, и время, которое требуется для его преодоления (время не превышает 106).
По мосту можно перемещаться в любом из двух направлений, два острова могут быть соединены несколькими мостами.
Временем перемещения пехотинца по острову можно пренебречь.

Формат вывода:
Если выполнить приказ министра невозможно, выведите на первой строке число -1.
В противном случае выведите на первой строке минимальное возможное среднее время
(с точностью 5 знаков после десятичной точки), которое требуется пехотинцам, чтобы добраться
до острова n, не менее чем с пятью знаками после десятичной точки. В следующих k строках
выведите пути пехотинцев: сначала число мостов в пути, а затем номера мостов в пути в том
порядке, в котором по ним следует перемещаться. Мосты нумеруются, начиная с единицы, в том
порядке, в котором они заданы во входном файле.

Пример:
Ввод:
6 9 3
1 2 3
1 3 6
1 3 7
2 3 4
3 4 5
3 6 7
3 5 7
4 6 3
5 6 2

Вывод:
14.666667
4 1 4 5 8 
2 2 6 
3 3 7 9

Алгоритм решения и доказательство его правильности находится в файле theory_solution.pdf